<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">
<h:head>
	<title>Productos</title>
	<meta charset="UTF-8"/>
	<link rel="stylesheet" type="text/css" href="css/comun.css"/>
	<link rel="stylesheet" type="text/css" href="css/productos.css"/>
</h:head>
<h:body>
	<h1>Productos</h1>
	
	<c:if test="${not empty productoBean.errores}">
		<ul class="errores">
		<c:forEach var="e" items="${productoBean.errores}">
			<li>${e}</li>
		</c:forEach>
		</ul>
	</c:if>

	<h:form method="post">
		<h:messages globalOnly="true" errorStyle="color: red; text-align: center"/>
	
		<h:inputHidden 
			value="#{productoBean.productoForm.id}"
			converter="javax.faces.Long"/>
		
		<table id="tabla-form" class="tabla-centrada">
			<tr>
				<td>Nombre</td>
				<td><h:inputText
						id="nombre"
						value="#{productoBean.productoForm.nombre}"
						required="true"
						requiredMessage="Nombre requerido"
						validator="#{productoBean.validarNombre}"
					/>
					<h:message for="nombre" errorStyle="color: red"/>
				</td>
			</tr>
			<tr>
				<td>Precio</td>
				<td><h:inputText
						id="precio"
						value="#{productoBean.productoForm.precio}"
						required="true"
						requiredMessage="Precio requerido"
						validator="#{productoBean.validarPrecio}"
						converter="javax.faces.Double"
						converterMessage="Precio invÃ¡lido"/>
					<h:message for="precio" errorStyle="color: red"/>
				</td>
			</tr>
			<tr>
				<td colspan="2">
					<input type="button" value="Cancelar" />
					<h:commandButton
						action="#{productoBean.guardar}" 
						value="Guardar"/>
				</td>
			</tr>
		</table>
	</h:form>
	
	<br/>
		
	<h:form>
		<table id="tabla-productos" class="tabla-centrada tabla-datos">
			<tr>
				<th>Id</th>
				<th>Nombre</th>
				<th>Precio</th>
				<th>Mostrar</th>
				<th>Eliminar</th>
			</tr>		
		<c:forEach var="p" items="${productoBean.productos}">
			<tr>
				<td>${p.id}</td>
				<td>${p.nombre}</td>
				<td>${p.precio}</td>
				<td>
					<h:commandLink
						action="#{productoBean.mostrar(p.id)}"
						value="mostrar"/>
				</td>
				<td>
					<h:commandLink
						onclick="javascript:return confirm('Eliminar?')"
						action="#{productoBean.eliminar(p.id)}"
						value="eliminar"/>
				</td>
			</tr>
		</c:forEach>
		</table>
	</h:form>
</h:body>
</html>